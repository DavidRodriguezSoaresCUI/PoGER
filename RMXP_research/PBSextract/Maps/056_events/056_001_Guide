[EVENT]
xy=[0, 5]
trigger=onAutorun
graphic="NPC 23"
direction=E

[PAGE]



Set Move Route :player
  Set property=through value=:ON
  Set property=opacity value={opa}
  Step E
  Set property=through value=:OFF
Set Move Route :self
  Set property=through value=:ON
  Set property=opacity value={opa}
  Step E
  Set property=through value=:OFF
s:pbSet(1,pbBattleChallenge.battleNumber)
if :TempPokemonChoice == 1
  Set Move Route :player
    Set property=through value=:ON
    Turn E
    Step E
    Step E
    Set property=through value=:OFF
  
Else
  Set Move Route :player
    Turn N
  Set Move Route :self
    Turn S
  
  Goto Choice Menu
Label Next Opponent
Move Event event=2, absolute_coordinates=[10,6], direction=K
s:pbBattleChallengeGraphic(get_character(2))
Set Move Route 2
  Set property=through value=:ON
  Step W
  Step W
  Step W
  Set property=through value=:OFF
s:pbSet(1,pbBattleChallengeBeginSpeech)
Show Text "\\v[1]"
if s:pbBattleChallengeBattle
  s:pbBattleChallenge.pbAddWin
  if s:pbBattleChallenge.pbMatchOver?
    s:pbBattleChallenge.setDecision(1)
    Wait ms=400
    Play SE="Door exit", volume=80, pitch=100
    Fadeout color=Black, ms=300
    Wait ms=400
    s:pbBattleChallenge.pbGoToStart
    Fadein ms=300
    End Execution
  Else
    Set Move Route 2
      Set property=through value=:ON
      Turn E
      Step E
      Step E
      Step E
      Set property=graphic value=",2,0"
      Set property=through value=:OFF
    Set Move Route :player
      Set property=through value=:ON
      Turn W
      Step W
      Step W
      Turn N
      Set property=through value=:OFF
    
    Set Move Route :self
      Turn S
    Show Text "\\rThanks for playing. Let me heal your party."
    Fadeout color=Black, ms=300
    Wait ms=400
    Restore All
    Fadein ms=300
    Wait ms=400
    Label Choice Menu
    s:pbSet(1,pbBattleChallenge.battleNumber)
    if s:$PokemonTemp.lastbattle!=nil
      Show Text "\\rBattle number \\v[1] is next. Are you ready?\\ch[2,0,Go on,Rest,Retire,Record]"
    Else
      Show Text "\\rBattle number \\v[1] is next. Are you ready?\\ch[2,0,Go on,Rest,Retire]"
    
    # Record.
    if :TempMoveChoice == 3
      Show Text "\\rWould you like to record your last battle?"
      Show Choices choices=['Yes', 'No'], default=2
      When 'Yes'
        s:pbRecordLastBattle
        Show Text "\\se[Pkmn exp full]The battle was recorded."
      When 'No'
      Goto Choice Menu
    
    # Retire.
    if :TempMoveChoice == 2
      Show Text "\\rAre you sure you want to quit your challenge?"
      Show Choices choices=['Yes', 'No'], default=2
      When 'Yes'
        s:pbBattleChallenge.setDecision(2)
        Play SE="Door exit", volume=80, pitch=100
        Fadeout color=Black, ms=300
        Wait ms=400
        s:pbBattleChallenge.pbGoToStart
        Fadein ms=300
        End Execution
      When 'No'
        Goto Choice Menu
    
    # Rest.
    if :TempMoveChoice == 1
      Show Text "\\rWould you like to save the game and continue later?"
      Show Choices choices=['Yes', 'No'], default=2
      When 'Yes'
        s:pbBattleChallenge.pbRest
        Show Text "Your game has been saved."
        Return to Title Screen
        End Execution
      When 'No'
        Goto Choice Menu
      Goto Choice Menu
    
    # Go on.
    if :TempMoveChoice == 0
      s:pbBattleChallenge.pbGoOn
      Set Move Route :self
        Turn E
      Set Move Route :player
        Set property=through value=:ON
        Turn E
        Step E
        Step E
        Set property=through value=:OFF
      Goto Next Opponent
    
  
Else
  s:pbBattleChallenge.setDecision(2)
  Play SE="Door exit", volume=80, pitch=100
  Fadeout color=Black, ms=300
  Wait ms=400
  s:pbBattleChallenge.pbGoToStart
  Fadein ms=300
  End Execution
[end]

